<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title><%= stock.name %> · Details</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="app-header">
    <a href="/" style="text-decoration:none;color:var(--primary);font-weight:700;margin-right:12px">← Back</a>
    <div class="app-title"><%= stock.name %></div>
  </div>

  <main style="max-width:1100px;margin:18px auto;padding:0 16px">
    <div class="stock-detail-header">
      <div class="logo-circle"><%= stock.symbol %></div>
      <div style="flex:1">
        <div class="detail-name"><%= stock.name %> <span style="font-weight:700;color:#94a3b8;font-size:13px">(<%= stock.symbol %>)</span></div>
        <div class="detail-price">₹<%= stock.price.toFixed(2) %> <span class="stock-change <%= stock.change>=0 ? 'up' : 'down' %>" style="font-size:14px;margin-left:10px"><%= stock.change >=0? '+' : '' %><%= stock.change %></span></div>
        <div class="timeframe" style="margin-top:6px">
          <button class="tf-btn active" data-range="1D">1D</button>
          <button class="tf-btn" data-range="1W">1W</button>
          <button class="tf-btn" data-range="1M">1M</button>
          <button class="tf-btn" data-range="1Y">1Y</button>
          <button class="tf-btn" data-range="5Y">5Y</button>
          <button class="tf-btn" data-range="ALL">ALL</button>
        </div>
      </div>
    </div>

    <div class="chart-card" style="margin-top:14px">
      <canvas id="stockChart" style="width:100%;height:38vh"></canvas>
    </div>

    <div class="action-row">
      <button class="btn sell">Sell</button>
      <button class="btn buy">Buy</button>
    </div>

    <div class="tabs" style="margin-top:18px">
      <div class="tab active">Overview</div>
      <div class="tab">News</div>
      <div class="tab">Events</div>
      <div class="tab">F&O</div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
  <script>
    const mockData = {
      '1D':[3020,3030,3045,3036,3040,3036,3032,3038],
      '1W':[2950,3000,3025,3050,3036,3070,3040],
      '1M':[2800,2900,3000,3100,3050,3036,2990,3020,3050],
      '1Y':[1200,1500,1800,2100,2500,3000,3036],
      '5Y':[400,600,800,1000,1400,2000,3036],
      'ALL':[50,100,200,400,800,1500,3036]
    };
    const ctx = document.getElementById('stockChart').getContext('2d');
    let chart = new Chart(ctx, {
      type:'line',
      data:{ labels: mockData['1D'].map((_,i)=>i+1), datasets:[{data:mockData['1D'],tension:0.3,fill:true,backgroundColor:'rgba(0,85,255,0.06)',borderColor:'rgba(0,85,255,0.9)',pointRadius:0}]},
      options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{display:false},y:{ticks:{callback:v=>'₹'+v}}} }
    });
    document.querySelectorAll('.tf-btn').forEach(btn=>btn.addEventListener('click',()=>{
      document.querySelectorAll('.tf-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const range = btn.getAttribute('data-range');
      const data = mockData[range]||mockData['1D'];
      chart.data.labels = data.map((_,i)=>i+1);
      chart.data.datasets[0].data = data;
      chart.update();
    }));
  </script>
</body>
</html>
